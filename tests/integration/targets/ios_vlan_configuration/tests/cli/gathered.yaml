---
- ansible.builtin.debug:
    msg: START ios_vlan_configuration gathered integration tests on connection={{ ansible_connection }}

- ansible.builtin.include_tasks: _remove_config.yaml
- ansible.builtin.include_tasks: _populate_config.yaml

- block:
    - name: Gather the existing ios_vlan_configuration running configuration
      register: result
      cisco.ios.ios_vlan_configuration:
        state: gathered

    - name: Convert configuration to dictionary
      ansible.builtin.include_tasks: "{{ role_path }}/tests/cli/_convert_to_dict.yaml"
      vars:
        var_list:
          - "{{ gathered['config'] }}"
          - "{{ result['gathered'] }}"

    - name: Assert that gathered dict is correctly generated
      ansible.builtin.assert:
        that:
          - convert_dict['results'][0]['ansible_facts']['dict_res'] == convert_dict['results'][1]['ansible_facts']['dict_res'] 

  always:
    - ansible.builtin.include_tasks: _remove_config.yaml
