---
gathered:
  config:
    - instance: "124"
      auto_route_target: false
      default_gateway_advertise: "enable"
      encapsulation: "vxlan"
      ip_local_learning: "disable"
      multicast_advertise: "disable"
      rd: "65374:103"
      re_originate_route_type5: true
      replication_type: "ingress"
      route_target_import:
        - "333:444"
        - "444:555"
      route_target_export:
        - "333:444"
        - "444:555"
    - instance: "126"
      auto_route_target: true
      default_gateway_advertise: "disable"
      encapsulation: "vxlan"
      ip_local_learning: "enable"
      multicast_advertise: "enable"
      rd: "65500:200"
      replication_type: "static"
      route_target_import:
        - "444:555"
        - "666:111"
      route_target_export:
        - "444:555"
        - "666:111"
    - instance: "128"
      encapsulation: "vxlan"
      rd: "65500:201"
      replication_type: "ingress"
      auto_route_target: true
rendered:
  commands:
      - "l2vpn evpn instance 124 vlan-based"
      - "route-target import 333:444"
      - "route-target import 444:555"
      - "route-target export 333:444"
      - "route-target export 444:555"
      - "encapsulation vxlan"
      - "rd 65374:103"
      - "no auto-route-target"
      - "replication-type ingress"
      - "ip local-learning disable"
      - "default-gateway advertise enable"
      - "multicast advertise disable"
      - "re-originate route-type5"
      - "exit"
      - "l2vpn evpn instance 126 vlan-based"
      - "route-target import 444:555"
      - "route-target import 666:111"
      - "route-target export 444:555"
      - "route-target export 666:111"
      - "encapsulation vxlan"
      - "rd 65500:200"
      - "replication-type static"
      - "ip local-learning enable"
      - "default-gateway advertise disable"
      - "multicast advertise enable"
      - "exit"
      - "l2vpn evpn instance 128 vlan-based"
      - "encapsulation vxlan"
      - "rd 65500:201"
      - "replication-type ingress"
      - "exit"
merged:
  commands:
    - "l2vpn evpn instance 128 vlan-based"
    - "route-target import 4343:444"
    - "route-target import 4343:555"
    - "route-target export 4343:444"
    - "route-target export 4343:555"
    - "ip local-learning disable"
    - "default-gateway advertise enable"
    - "multicast advertise disable"
    - "re-originate route-type5"
    - "exit"
  after:
    - instance: "124"
      auto_route_target: false
      default_gateway_advertise: "enable"
      encapsulation: "vxlan"
      ip_local_learning: "disable"
      multicast_advertise: "disable"
      rd: "65374:103"
      re_originate_route_type5: true
      replication_type: "ingress"
      route_target_import:
        - "333:444"
        - "444:555"
      route_target_export:
        - "333:444"
        - "444:555"
    - instance: "126"
      auto_route_target: true
      default_gateway_advertise: "disable"
      encapsulation: "vxlan"
      ip_local_learning: "enable"
      multicast_advertise: "enable"
      rd: "65500:200"
      replication_type: "static"
      route_target_import:
        - "444:555"
        - "666:111"
      route_target_export:
        - "444:555"
        - "666:111"
    - instance: "128"
      encapsulation: "vxlan"
      rd: "65500:201"
      replication_type: "ingress"
      auto_route_target: true
      default_gateway_advertise: "enable"
      ip_local_learning: "disable"
      multicast_advertise: "disable"
      re_originate_route_type5: true
      route_target_import:
        - "4343:444"
        - "4343:555"
      route_target_export:
        - "4343:444"
        - "4343:555"
replaced:
  commands:
    - "no l2vpn evpn instance 124 vlan-based"
    - "l2vpn evpn instance 126 vlan-based"
    - "no route-target import 666:111"
    - "no route-target export 666:111"
    - "no rd 65500:200"
    - "replication-type ingress"
    - "no ip local-learning enable"
    - "no default-gateway advertise disable"
    - "no multicast advertise enable"
    - "exit"
    - "l2vpn evpn instance 128 vlan-based"
    - "route-target import 123:555"
    - "route-target export 123:555"
    - "no auto-route-target"
    - "exit"
  after:
    - auto_route_target: true
      encapsulation: "vxlan"
      instance: "126"
      replication_type: "ingress"
      route_target_export:
        - "444:555"
      route_target_import:
        - "444:555"
    - auto_route_target: false
      encapsulation: "vxlan"
      instance: "128"
      rd: "65500:201"
      replication_type: "ingress"
      route_target_export:
        - "123:555"
      route_target_import:
        - "123:555"
deleted:
  commands:
    - "no l2vpn evpn instance 124 vlan-based"
    - "no l2vpn evpn instance 126 vlan-based"
